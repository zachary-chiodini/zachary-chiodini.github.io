<!DOCTYPE html>
<html>
  <head>
    <meta prefix="og: http://ogp.me/ns#" property="og:type" content="website" />
    <meta prefix="og: http://ogp.me/ns#" property="og:title" content="The Perceptron Unit" />
    <meta prefix="og: http://ogp.me/ns#" property="og:description" content="This page presents a description of a single perceptron unit and its applications." />
    <meta prefix="og: http://ogp.me/ns#" property="og:image" content="preview.png" />
    <meta prefix="og: http://ogp.me/ns#" property="og:url" content="https://zachary-chiodini.github.io/perceptron/perceptron.html?x=153&y=57" />
  </head>
  <title>The Perceptron</title>
  <body style="background-color:#002240; color:white; padding:30px">
    <h1 style="color:#02FF02">The Perceptron Unit</h1>
    <p align="justify">
      This page serves as a learning tool to assist in understanding a single perceptron unit and its applications,
      outside of multilayered nueral networks, with C++ and Python.
      Multilayered neural networks are the talk of the town. 
      However, let's not get ahead of ourselves.
      Instead, let's start with a discussion of the units within the network, perceptrons.
      Once the perceptron is understood, a neural network can follow.
    </p>
    <p align="justify">
      This page is not meant to be an exhaustive source of perceptron knowledge.
      It is meant to be breif and straight to the point.
      Additionally, this page may serve as a breif introductory comparison between C++ and Python.
    </p>
    <h1 style="color:#02FF02">Mathematical Model</h1>
    <p align="justify">
      Let's describe a perceptron by a function f.
      The mathematical model for a typical perceptron is a simple step function (1), where τ is called the threshold.
      The function can be rewritten so that the inequalities are set to zero (2).
      In this form, the threshold τ is often referred to as the bias b, where b = -τ.
      This is called a boolean function, because its output can only be either 1 or 0, which corresponds to true or false.
      A graph of the step function is shown to the right. It's no coincidence that it looks like a step.
    </p>
    <table align="center" style="border-spacing:0px" >
      <tr>
        <td><table align="center" style="border-spacing:0px">
          <tr><td><p align="center"><img style="width:50%; height:50%" src="step_function.png" /><p></td></tr>
          <tr><td><p align="center"><img style="width:50%; height:50%" src="step_function_2.png" /><p></td></tr>
        </table></td>
        <td><img style="width:75%; height:75%"; src="step_graph.png" /></td>
      </tr>
    </table
    <p align="justify">
      The perceptron is really that simple, but the function is hiding some important details.
      The input for the perceptron is a weighted sum, which is given by the dot product of two vectors: 
      an inpute vector x and the network vector ω, each having n components (3). 
      The input vector contains the data to be interpreted by the perceptron. 
      The network vector contains the weight or coefficient for each input vector component.
    </p>
    <p align="center"><img style="width:25%; height:25%" src="step_function_3.png" /></p>
    <p align="justify">
      To make things more compact, we can increase the size of both vectors to n + 1 and 
      force the first component of the input vector to be -1
      and the first component of the network vector to be the threshold τ,
      so that the first product in the sum is -τ. 
      Alternatively, we can force the first component of the input vector to be 1 
      and the first component of the network vector to be the bias b (4).
    </p>
    <p align="center"><img style="width:50%; height:50%" src="step_function_4.png" /></p>
    <p align="justify">
      A perceptron unit with specified weights can be used to make simple decisions. 
      For example, a perceptron unit could be used to determine whether or not one should get up in the morning.
      The input vector could hold boolean values for
      good wheather, job duties, errands to run, hobbies to do, friends to vist, fitness goals, hungry and poor hygeine,
      each being 0 or 1 for true or false.
      The weights of which correspond to their importance.
      The bias could represent one's personal motivation. 
      Since b = -τ, a greater bias lowers the threshold of the perceptron.
      After feeding the data into the perceptron, if it outputs a 1, you should get up. Otherwise, take it easy.
    </p>
    <h1 style="color:#02FF02">In Python and C++</h1>
    <p align="justify">
      Below is the code for a perceptron in C++ and Python.
      The C++ code is more in depth and shows more clearly what is going on.
      In general, C++ syntax is bulkier than Python, but allows for more control over the program.
      A lot of what is explicitly defined in C++ is done "behind the scenes" in Python.
      Nonetheless, moving forward, it will be easy to see that the two languages share a lot in common.
    </p>
    <table align="center" style="border-spacing:0px">
      <tr>
        <td><h2 style="color:#02FF02; text-align:center">Python</h2></td>
        <td><h2 style="color:#02FF02; text-align:center ">C++</h2></td>
      </tr>
      <tr><td>
        <div style="height:300px; width:600px; overflow:auto; font-family:courier">
<table class="table"><tr><td><div class="linenodiv" style="background-color: #454545; padding-right: 10px"><pre style="line-height: 125%">1
2</pre></div></td><td class="code"><div style="background: #002240"><pre style="line-height: 125%"><span></span><span style="color: #FF8000">def</span> <span style="color: #5E5EFF">perceptron</span>( <span style="color: #FFFFFF">x</span>, <span style="color: #FFFFFF">w</span> ) :
    <span style="color: #FF8000">return</span> <span style="color: #FF69B4">int</span>( <span style="color: #FF69B4">sum</span>( <span style="color: #FFFFFF">xi</span><span style="color: #FF8000">*</span><span style="color: #FFFFFF">wi</span> <span style="color: #FF8000">for</span> <span style="color: #FFFFFF">xi</span>, <span style="color: #FFFFFF">wi</span> <span style="color: #FF8000">in</span> <span style="color: #FF69B4">zip</span>( <span style="color: #FFFFFF">x</span>, <span style="color: #FFFFFF">w</span> ) ) <span style="color: #FF8000">&gt;</span> <span style="color: #FF00FF">0</span> )
</pre></div>
  </td></tr></table>
        </div>
          </td><td>
        <div style="height:300px; width:600px; overflow:auto; font-family:courier">
<table class="table"><tr><td><div class="linenodiv" style="background-color: #454545; padding-right: 10px"><pre style="line-height: 125%">1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div style="background: #002240"><pre style="line-height: 125%"><span></span><span style="color: #DD0000"># include &lt;vector&gt;</span>
<span style="color: #FF8000">int</span> <span style="color: #5E5EFF">perceptron</span>( <span style="color: #FFFFFF">vector</span><span style="color: #FF8000">&lt;float&gt;</span> <span style="color: #FFFFFF">x</span>, <span style="color: #FF8000">const</span> <span style="color: #FFFFFF">vector</span><span style="color: #FF8000">&lt;float&gt;&amp;</span> <span style="color: #FFFFFF">w</span> ) {
    <span style="color: #FF8000">float</span> <span style="color: #FFFFFF">dot_product</span> <span style="color: #FF8000">=</span> <span style="color: #FF00FF">0</span>;
    <span style="color: #FFFFFF">vector</span><span style="color: #FF8000">&lt;float&gt;::</span><span style="color: #FFFFFF">const_iterator</span> <span style="color: #FFFFFF">xi</span>, <span style="color: #FFFFFF">wi</span>;
    <span style="color: #FF8000">for</span> ( <span style="color: #FFFFFF">xi</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">x</span>.<span style="color: #FFFFFF">begin</span>(), <span style="color: #FFFFFF">wi</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">w</span>.<span style="color: #FFFFFF">begin</span>(); <span style="color: #FFFFFF">xi</span> <span style="color: #FF8000">!=</span> <span style="color: #FFFFFF">x</span>.<span style="color: #FFFFFF">end</span>(); <span style="color: #FF8000">++</span><span style="color: #FFFFFF">xi</span>, <span style="color: #FF8000">++</span><span style="color: #FFFFFF">wi</span> ) {
        <span style="color: #FFFFFF">dot_product</span> <span style="color: #FF8000">+=</span> <span style="color: #FF8000">*</span><span style="color: #FFFFFF">xi</span> <span style="color: #FF8000">*</span> <span style="color: #FF8000">*</span><span style="color: #FFFFFF">wi</span>;
    }
    <span style="color: #FF8000">return</span> <span style="color: #FF8000">int</span>( <span style="color: #FFFFFF">dot_product</span> <span style="color: #FF8000">&gt;</span> <span style="color: #FF00FF">0</span> );
</pre></div>
</td></tr></table>
        </div>
        </td></tr>
    </table>
    <h1 style="color:#02FF02">The Perceptron Training Algorithm and Classification</h1>
    <p align="justify">
      A more interesting application uses the perceptron training algorithm.
      This enables the perceptron to compute the correct network given a training set, 
      which is a set of input vectors and their expected outputs or target values.
      If a large enough representative sample of input vectors are in the training set,
      the network weights computed by the training algorithm 
      can then be used to classify all the data from which the training set was sampled,
      as long as the data is linearly separable.
    </p>
    <p align="justify">
      The condition that the data must be linearly separable comes from the mathematical model of the perceptron.
      In 2 dimensions, given an input vector ( 1, x, y ) and a network vector ( b, ω1, ω2 ), the dot product is b + ω1x + ω2y,
      and the inequalities become b + ω1x + ω2y > 0 for an output of 1 and b + ω1x + ω2y <= 0 for an output of 0. 
      Replacing the inequalities with an equals sign creates a line (5).
    </p>
    <p align="center"><img style="width:18%; height:18%" src="line.png" /></p>
    <p align="justify">
      Therefore, everything above this line gives an output of 1 and everything on or below this line gives an output of 0.
      The perceptron can only classify data that can be separated by this line. 
      This is also true for n dimensions in which the line is a hyperplane.
    </p>
    <p align="justify">
      The training algorithm is as follows:
    </p>
    <p align="center"><img style="width:60%; height:60%" src="training_algorithm.png" /></p>
    <h1 style="color:#02FF02">Network Class</h1>
    <p align="justify">
      A class Network is created in Python and C++ to store everything we need to start training and testing the perceptron.
      The bias coeficient in the input vectors is added automatically to make inputing data into the 
      perceptron and learning algorithm easier.
    </p>
    <table align="center" style="border-spacing:0px">
      <tr>
        <td><h2 style="color:#02FF02; text-align:center">Python</h2></td>
        <td><h2 style="color:#02FF02; text-align:center ">C++</h2></td>
      </tr>
      <tr><td>
        <div style="height:300px; width:600px; overflow:auto; font-family:courier">
  <table class="table"><tr><td><div class="linenodiv" style="background-color: #454545; padding-right: 10px"><pre style="line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57</pre></div></td><td class="code"><div style="background: #002240"><pre style="line-height: 125%"><span></span><span style="color: #FF8000">from</span> <span style="color: #FFFFFF">random</span> <span style="color: #FF8000">import</span> <span style="color: #FFFFFF">random</span>

<span style="color: #FF8000">class</span> <span style="color: #5E5EFF">Network</span> :
    <span style="color: #02FF02">&#39;&#39;&#39;</span>
<span style="color: #02FF02">    +-------------------------------+</span>
<span style="color: #02FF02">    |    Unit Perceptron Network    |</span>
<span style="color: #02FF02">    +---+---------------------------+</span>
<span style="color: #02FF02">    | x | 2D list of input vectors  |</span>
<span style="color: #02FF02">    +---+---------------------------+</span>
<span style="color: #02FF02">    | t | list of target values     |</span>
<span style="color: #02FF02">    +---+---------------------------+</span>
<span style="color: #02FF02">    | b | bias                      |</span>
<span style="color: #02FF02">    +---+---------------------------+</span>
<span style="color: #02FF02">    | r | learning rate             |</span>
<span style="color: #02FF02">    +---+---------------------------+</span>
<span style="color: #02FF02">    | w | network of weights (list) |</span>
<span style="color: #02FF02">    +---+---------------------------+</span>
<span style="color: #02FF02">    &#39;&#39;&#39;</span>
    <span style="color: #FF8000">def</span> <span style="color: #5E5EFF">__init__</span>( <span style="color: #FF69B4">self</span> ) :
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">results</span> <span style="color: #FF8000">=</span> []
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">network</span> <span style="color: #FF8000">=</span> []

    <span style="color: #FF8000">def</span> <span style="color: #5E5EFF">__update</span>( <span style="color: #FF69B4">self</span>, <span style="color: #FFFFFF">xi</span>, <span style="color: #FFFFFF">w</span>, <span style="color: #FFFFFF">r</span>, <span style="color: #FFFFFF">ti</span>, <span style="color: #FFFFFF">ai</span> ) :
        <span style="color: #FFFFFF">w</span>[ <span style="color: #FF00FF">0</span> ] <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">w</span>[ <span style="color: #FF00FF">0</span> ] <span style="color: #FF8000">+</span> <span style="color: #FFFFFF">r</span><span style="color: #FF8000">*</span>( <span style="color: #FFFFFF">ti</span> <span style="color: #FF8000">-</span> <span style="color: #FFFFFF">ai</span> ) <span style="color: #DD0000">#bias</span>
        <span style="color: #FF8000">for</span> <span style="color: #FFFFFF">j</span> <span style="color: #FF8000">in</span> <span style="color: #FF69B4">range</span>( <span style="color: #FF69B4">len</span> ( <span style="color: #FFFFFF">xi</span> ) ) :
            <span style="color: #FFFFFF">w</span>[ <span style="color: #FFFFFF">j</span> <span style="color: #FF8000">+</span> <span style="color: #FF00FF">1</span> ] <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">w</span>[ <span style="color: #FFFFFF">j</span> <span style="color: #FF8000">+</span> <span style="color: #FF00FF">1</span> ] <span style="color: #FF8000">+</span> <span style="color: #FFFFFF">r</span><span style="color: #FF8000">*</span>( <span style="color: #FFFFFF">ti</span> <span style="color: #FF8000">-</span> <span style="color: #FFFFFF">ai</span> )<span style="color: #FF8000">*</span><span style="color: #FFFFFF">xi</span>[ <span style="color: #FFFFFF">j</span> ]
        <span style="color: #FF8000">return</span> <span style="color: #FFFFFF">w</span>

    <span style="color: #FF8000">def</span> <span style="color: #5E5EFF">__output</span>( <span style="color: #FF69B4">self</span>, <span style="color: #FFFFFF">x</span>, <span style="color: #FFFFFF">w</span> ) :
        <span style="color: #FF8000">return</span> [ <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">perceptron</span>( <span style="color: #FFFFFF">xi</span>, <span style="color: #FFFFFF">w</span> ) <span style="color: #FF8000">for</span> <span style="color: #FFFFFF">xi</span> <span style="color: #FF8000">in</span> <span style="color: #FFFFFF">x</span> ]
    
    <span style="color: #FF8000">def</span> <span style="color: #5E5EFF">perceptron</span>( <span style="color: #FF69B4">self</span>, <span style="color: #FFFFFF">x</span>, <span style="color: #FFFFFF">w</span> ) :
        <span style="color: #FF8000">return</span> <span style="color: #FF69B4">int</span>( <span style="color: #FF69B4">sum</span>( <span style="color: #FFFFFF">xi</span><span style="color: #FF8000">*</span><span style="color: #FFFFFF">wi</span> <span style="color: #FF8000">for</span> <span style="color: #FFFFFF">xi</span>, <span style="color: #FFFFFF">wi</span> <span style="color: #FF8000">in</span> <span style="color: #FF69B4">zip</span>( [<span style="color: #FF00FF">1</span>] <span style="color: #FF8000">+</span> <span style="color: #FFFFFF">x</span>, <span style="color: #FFFFFF">w</span> ) ) <span style="color: #FF8000">&gt;</span> <span style="color: #FF00FF">0</span> )

    <span style="color: #FF8000">def</span> <span style="color: #5E5EFF">train</span>( <span style="color: #FF69B4">self</span>, <span style="color: #FFFFFF">x</span>, <span style="color: #FFFFFF">t</span>, <span style="color: #FFFFFF">b</span>, <span style="color: #FFFFFF">r</span> ) :
        <span style="color: #FFFFFF">w</span> <span style="color: #FF8000">=</span> [ <span style="color: #FF00FF">0.5</span> <span style="color: #FF8000">-</span> <span style="color: #FFFFFF">random</span>() <span style="color: #FF8000">for</span> <span style="color: #FFFFFF">i</span> <span style="color: #FF8000">in</span> <span style="color: #FFFFFF">x</span>[<span style="color: #FF00FF">0</span>] ]
        <span style="color: #FFFFFF">w</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">insert</span>( <span style="color: #FF00FF">0</span>, <span style="color: #FFFFFF">b</span> ) <span style="color: #DD0000">#bias</span>
        <span style="color: #FF8000">while</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">__output</span>( <span style="color: #FFFFFF">x</span>, <span style="color: #FFFFFF">w</span> ) <span style="color: #FF8000">!=</span> <span style="color: #FFFFFF">t</span> :
            <span style="color: #FF8000">for</span> <span style="color: #FFFFFF">xi</span>, <span style="color: #FFFFFF">ti</span> <span style="color: #FF8000">in</span> <span style="color: #FF69B4">zip</span>( <span style="color: #FFFFFF">x</span>, <span style="color: #FFFFFF">t</span> ) :
                <span style="color: #FFFFFF">ai</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">perceptron</span>( <span style="color: #FFFFFF">xi</span>, <span style="color: #FFFFFF">w</span> )
                <span style="color: #FFFFFF">w</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">__update</span>( <span style="color: #FFFFFF">xi</span>, <span style="color: #FFFFFF">w</span>, <span style="color: #FFFFFF">r</span>, <span style="color: #FFFFFF">ti</span>, <span style="color: #FFFFFF">ai</span> )
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">network</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">w</span>
        <span style="color: #FF8000">return</span>

    <span style="color: #FF8000">def</span> <span style="color: #5E5EFF">test</span>( <span style="color: #FF69B4">self</span>, <span style="color: #FFFFFF">x</span> ) :
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">results</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">__output</span>( <span style="color: #FFFFFF">x</span>, <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">network</span> )
        <span style="color: #FF8000">return</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">results</span>
    
    <span style="color: #FF8000">def</span> <span style="color: #5E5EFF">show_output</span>( <span style="color: #FF69B4">self</span> ) :
        <span style="color: #FFFFFF">output</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">map</span>( <span style="color: #FF69B4">str</span>, <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">results</span> )
        <span style="color: #FF8000">print</span>( <span style="color: #02FF02">&#39;Unit ouput: {}&#39;</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">format</span>( <span style="color: #02FF02">&#39; &#39;</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">join</span>( <span style="color: #FFFFFF">output</span> ) ) )
        <span style="color: #FF8000">return</span>
    
    <span style="color: #FF8000">def</span> <span style="color: #5E5EFF">show_network</span>( <span style="color: #FF69B4">self</span> ) :
        <span style="color: #FFFFFF">network</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">map</span>( <span style="color: #FF69B4">str</span>, <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">network</span> )
        <span style="color: #FF8000">print</span>( <span style="color: #02FF02">&#39;Unit network: {}&#39;</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">format</span>( <span style="color: #02FF02">&#39; &#39;</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">join</span>( <span style="color: #FFFFFF">network</span> ) ) )
        <span style="color: #FF8000">return</span>
</pre></div>
</td></tr></table>
        </div>
          </td><td>
        <div style="height:300px; width:600px; overflow:auto; font-family:courier">
<table class="table"><tr><td><div class="linenodiv" style="background-color: #454545; padding-right: 10px"><pre style="line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99</pre></div></td><td class="code"><div style="background: #002240"><pre style="line-height: 125%"><span></span><span style="color: #DD0000"># include &lt;iostream&gt;</span>
<span style="color: #DD0000"># include &lt;vector&gt;</span>
<span style="color: #DD0000"># include &lt;random&gt;</span>
<span style="color: #FF8000">using</span> <span style="color: #FF8000">namespace</span> <span style="color: #FFFFFF">std</span>;

<span style="color: #FF8000">class</span> <span style="color: #5E5EFF">Network</span> {
    <span style="color: #DD0000">/*</span>
<span style="color: #DD0000">    +---------------------------------+</span>
<span style="color: #DD0000">    |     Unit Perceptron Network     |</span>
<span style="color: #DD0000">    +---+-----------------------------+</span>
<span style="color: #DD0000">    | x | 2D vector of input vectors  |</span>
<span style="color: #DD0000">    +---+-----------------------------+</span>
<span style="color: #DD0000">    | t | vector of target values     |</span>
<span style="color: #DD0000">    +---+-----------------------------+</span>
<span style="color: #DD0000">    | b | bias                        |</span>
<span style="color: #DD0000">    +---+-----------------------------+</span>
<span style="color: #DD0000">    | r | learning rate               |</span>
<span style="color: #DD0000">    +---+-----------------------------+</span>
<span style="color: #DD0000">    | w | network of weights (vector) |</span>
<span style="color: #DD0000">    +---+-----------------------------+</span>
<span style="color: #DD0000">    */</span>
<span style="color: #FF8000">private:</span>
    <span style="color: #FFFFFF">vector</span><span style="color: #FF8000">&lt;float&gt;</span> <span style="color: #FFFFFF">update</span>(
        <span style="color: #FF8000">const</span> <span style="color: #FFFFFF">vector</span><span style="color: #FF8000">&lt;float&gt;&amp;</span> <span style="color: #FFFFFF">xi</span>, <span style="color: #FFFFFF">vector</span><span style="color: #FF8000">&lt;float&gt;&amp;</span> <span style="color: #FFFFFF">w</span>,
        <span style="color: #FF8000">const</span> <span style="color: #FF8000">float&amp;</span> <span style="color: #FFFFFF">r</span>, <span style="color: #FF8000">const</span> <span style="color: #FF8000">int&amp;</span> <span style="color: #FFFFFF">ti</span>, <span style="color: #FF8000">const</span> <span style="color: #FF8000">int&amp;</span> <span style="color: #FFFFFF">ai</span>
    ) {
        <span style="color: #FFFFFF">w</span>[<span style="color: #FF00FF">0</span>] <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">w</span>[<span style="color: #FF00FF">0</span>] <span style="color: #FF8000">+</span> <span style="color: #FFFFFF">r</span><span style="color: #FF8000">*</span>( <span style="color: #FFFFFF">ti</span> <span style="color: #FF8000">-</span> <span style="color: #FFFFFF">ai</span> ); <span style="color: #DD0000">//bias</span>
        <span style="color: #FF8000">for</span> ( <span style="color: #FF8000">int</span> <span style="color: #FFFFFF">j</span> <span style="color: #FF8000">=</span> <span style="color: #FF00FF">0</span>; <span style="color: #FFFFFF">j</span> <span style="color: #FF8000">&lt;</span> <span style="color: #FFFFFF">xi</span>.<span style="color: #FFFFFF">size</span>(); <span style="color: #FF8000">++</span><span style="color: #FFFFFF">j</span> ) {
            <span style="color: #FFFFFF">w</span>[ <span style="color: #FFFFFF">j</span> <span style="color: #FF8000">+</span> <span style="color: #FF00FF">1</span> ] <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">w</span>[ <span style="color: #FFFFFF">j</span> <span style="color: #FF8000">+</span> <span style="color: #FF00FF">1</span> ] <span style="color: #FF8000">+</span> <span style="color: #FFFFFF">r</span><span style="color: #FF8000">*</span>( <span style="color: #FFFFFF">ti</span> <span style="color: #FF8000">-</span> <span style="color: #FFFFFF">ai</span> )<span style="color: #FF8000">*</span><span style="color: #FFFFFF">xi</span>[ <span style="color: #FFFFFF">j</span> ];
        }
        <span style="color: #FF8000">return</span> <span style="color: #FFFFFF">w</span>;
    }
    <span style="color: #FFFFFF">vector</span><span style="color: #FF8000">&lt;int&gt;</span> <span style="color: #FFFFFF">output</span>( 
        <span style="color: #FF8000">const</span> <span style="color: #FFFFFF">vector</span><span style="color: #FF8000">&lt;</span><span style="color: #FFFFFF">vector</span><span style="color: #FF8000">&lt;float&gt;&gt;&amp;</span> <span style="color: #FFFFFF">x</span>, <span style="color: #FF8000">const</span> <span style="color: #FFFFFF">vector</span><span style="color: #FF8000">&lt;float&gt;&amp;</span> <span style="color: #FFFFFF">w</span> 
    ) {
        <span style="color: #FFFFFF">vector</span><span style="color: #FF8000">&lt;int&gt;</span> <span style="color: #FFFFFF">out</span>;
        <span style="color: #FFFFFF">vector</span><span style="color: #FF8000">&lt;</span><span style="color: #FFFFFF">vector</span><span style="color: #FF8000">&lt;float&gt;&gt;::</span><span style="color: #FFFFFF">const_iterator</span> <span style="color: #FFFFFF">xi</span>;
        <span style="color: #FF8000">for</span> (<span style="color: #FFFFFF">xi</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">x</span>.<span style="color: #FFFFFF">begin</span>(); <span style="color: #FFFFFF">xi</span> <span style="color: #FF8000">!=</span> <span style="color: #FFFFFF">x</span>.<span style="color: #FFFFFF">end</span>(); <span style="color: #FF8000">++</span><span style="color: #FFFFFF">xi</span>) {
            <span style="color: #FFFFFF">out</span>.<span style="color: #FFFFFF">push_back</span>( <span style="color: #FFFFFF">perceptron</span>( <span style="color: #FF8000">*</span><span style="color: #FFFFFF">xi</span>, <span style="color: #FFFFFF">w</span> ) );
        }
        <span style="color: #FF8000">return</span> <span style="color: #FFFFFF">out</span>;
    }
<span style="color: #FF8000">public:</span>
    <span style="color: #FFFFFF">vector</span><span style="color: #FF8000">&lt;int&gt;</span> <span style="color: #FFFFFF">results</span>;
    <span style="color: #FFFFFF">vector</span><span style="color: #FF8000">&lt;float&gt;</span> <span style="color: #FFFFFF">network</span>;
    <span style="color: #FF8000">int</span> <span style="color: #5E5EFF">perceptron</span>( <span style="color: #FFFFFF">vector</span><span style="color: #FF8000">&lt;float&gt;</span> <span style="color: #FFFFFF">x</span>, <span style="color: #FF8000">const</span> <span style="color: #FFFFFF">vector</span><span style="color: #FF8000">&lt;float&gt;&amp;</span> <span style="color: #FFFFFF">w</span> ) {
        <span style="color: #FFFFFF">x</span>.<span style="color: #FFFFFF">insert</span>( <span style="color: #FFFFFF">x</span>.<span style="color: #FFFFFF">begin</span>(), <span style="color: #FF00FF">1</span> ); <span style="color: #DD0000">//bias coefficient</span>
        <span style="color: #FF8000">float</span> <span style="color: #FFFFFF">dot_product</span> <span style="color: #FF8000">=</span> <span style="color: #FF00FF">0</span>;
        <span style="color: #FFFFFF">vector</span><span style="color: #FF8000">&lt;float&gt;::</span><span style="color: #FFFFFF">const_iterator</span> <span style="color: #FFFFFF">xi</span>, <span style="color: #FFFFFF">wi</span>;
        <span style="color: #FF8000">for</span> ( <span style="color: #FFFFFF">xi</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">x</span>.<span style="color: #FFFFFF">begin</span>(), <span style="color: #FFFFFF">wi</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">w</span>.<span style="color: #FFFFFF">begin</span>(); <span style="color: #FFFFFF">xi</span> <span style="color: #FF8000">!=</span> <span style="color: #FFFFFF">x</span>.<span style="color: #FFFFFF">end</span>(); <span style="color: #FF8000">++</span><span style="color: #FFFFFF">xi</span>, <span style="color: #FF8000">++</span><span style="color: #FFFFFF">wi</span> ) {
            <span style="color: #FFFFFF">dot_product</span> <span style="color: #FF8000">+=</span> <span style="color: #FF8000">*</span><span style="color: #FFFFFF">xi</span> <span style="color: #FF8000">*</span> <span style="color: #FF8000">*</span><span style="color: #FFFFFF">wi</span>;
        }
        <span style="color: #FF8000">return</span> <span style="color: #FF8000">int</span>( <span style="color: #FFFFFF">dot_product</span> <span style="color: #FF8000">&gt;</span> <span style="color: #FF00FF">0</span> );
    }
    <span style="color: #FF8000">void</span> <span style="color: #5E5EFF">train</span>( 
        <span style="color: #FF8000">const</span> <span style="color: #FFFFFF">vector</span><span style="color: #FF8000">&lt;</span><span style="color: #FFFFFF">vector</span><span style="color: #FF8000">&lt;float&gt;&gt;&amp;</span> <span style="color: #FFFFFF">x</span>, <span style="color: #FF8000">const</span> <span style="color: #FFFFFF">vector</span><span style="color: #FF8000">&lt;int&gt;&amp;</span> <span style="color: #FFFFFF">t</span>,
        <span style="color: #FF8000">const</span> <span style="color: #FF8000">float</span> <span style="color: #FFFFFF">b</span>, <span style="color: #FF8000">const</span> <span style="color: #FF8000">float</span> <span style="color: #FFFFFF">r</span>
    ) {
        <span style="color: #FFFFFF">random_device</span> <span style="color: #FFFFFF">random</span>; <span style="color: #DD0000">// int random number generator</span>
        <span style="color: #FFFFFF">uniform_real_distribution</span><span style="color: #FF8000">&lt;double&gt;</span> <span style="color: #FFFFFF">uniform</span>(<span style="color: #FF8000">-</span><span style="color: #FF00FF">0.5</span>, <span style="color: #FF00FF">0.5</span>);
        <span style="color: #FFFFFF">vector</span><span style="color: #FF8000">&lt;float&gt;</span> <span style="color: #FFFFFF">w</span>;
        <span style="color: #FF8000">for</span> ( <span style="color: #FF8000">int</span> <span style="color: #FFFFFF">i</span> <span style="color: #FF8000">=</span> <span style="color: #FF00FF">0</span>; <span style="color: #FFFFFF">i</span> <span style="color: #FF8000">&lt;</span> <span style="color: #FFFFFF">x</span>[<span style="color: #FF00FF">0</span>].<span style="color: #FFFFFF">size</span>(); <span style="color: #FF8000">++</span><span style="color: #FFFFFF">i</span> ) {
            <span style="color: #FFFFFF">w</span>.<span style="color: #FFFFFF">push_back</span>( <span style="color: #FFFFFF">uniform</span>( <span style="color: #FFFFFF">random</span> ) );
        }
        <span style="color: #FFFFFF">w</span>.<span style="color: #FFFFFF">insert</span>( <span style="color: #FFFFFF">w</span>.<span style="color: #FFFFFF">begin</span>(), <span style="color: #FFFFFF">b</span> ); <span style="color: #DD0000">//bias</span>
        <span style="color: #FFFFFF">vector</span><span style="color: #FF8000">&lt;int&gt;::</span><span style="color: #FFFFFF">const_iterator</span> <span style="color: #FFFFFF">ti</span>;
        <span style="color: #FFFFFF">vector</span><span style="color: #FF8000">&lt;</span><span style="color: #FFFFFF">vector</span><span style="color: #FF8000">&lt;float&gt;&gt;::</span><span style="color: #FFFFFF">const_iterator</span> <span style="color: #FFFFFF">xi</span>;
        <span style="color: #FF8000">while</span> ( <span style="color: #FFFFFF">output</span>( <span style="color: #FFFFFF">x</span>, <span style="color: #FFFFFF">w</span> ) <span style="color: #FF8000">!=</span> <span style="color: #FFFFFF">t</span> ) {
            <span style="color: #FF8000">for</span> (<span style="color: #FFFFFF">xi</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">x</span>.<span style="color: #FFFFFF">begin</span>(), <span style="color: #FFFFFF">ti</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">t</span>.<span style="color: #FFFFFF">begin</span>(); <span style="color: #FFFFFF">xi</span> <span style="color: #FF8000">!=</span> <span style="color: #FFFFFF">x</span>.<span style="color: #FFFFFF">end</span>(); <span style="color: #FF8000">++</span><span style="color: #FFFFFF">xi</span>, <span style="color: #FF8000">++</span><span style="color: #FFFFFF">ti</span>) {
                <span style="color: #FF8000">int</span> <span style="color: #FFFFFF">ai</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">perceptron</span>( <span style="color: #FF8000">*</span><span style="color: #FFFFFF">xi</span>, <span style="color: #FFFFFF">w</span> );
                <span style="color: #FFFFFF">w</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">update</span>( <span style="color: #FF8000">*</span><span style="color: #FFFFFF">xi</span>, <span style="color: #FFFFFF">w</span>, <span style="color: #FFFFFF">r</span>, <span style="color: #FF8000">*</span><span style="color: #FFFFFF">ti</span>, <span style="color: #FFFFFF">ai</span> );
            }
        }
        <span style="color: #FFFFFF">network</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">w</span>;
        <span style="color: #FF8000">return</span>;
    }
    <span style="color: #FFFFFF">vector</span><span style="color: #FF8000">&lt;int&gt;</span> <span style="color: #FFFFFF">test</span>( <span style="color: #FFFFFF">vector</span><span style="color: #FF8000">&lt;</span><span style="color: #FFFFFF">vector</span><span style="color: #FF8000">&lt;float&gt;&gt;&amp;</span> <span style="color: #FFFFFF">x</span> ) {
        <span style="color: #FFFFFF">results</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">output</span>( <span style="color: #FFFFFF">x</span>, <span style="color: #FFFFFF">network</span> );
        <span style="color: #FF8000">return</span> <span style="color: #FFFFFF">results</span>;
    }
    <span style="color: #FF8000">void</span> <span style="color: #FFFFFF">show_output</span>() {
        <span style="color: #FFFFFF">cout</span> <span style="color: #FF8000">&lt;&lt;</span> <span style="color: #02FF02">&quot;Unit output: &quot;</span>;
        <span style="color: #FFFFFF">vector</span><span style="color: #FF8000">&lt;int&gt;::</span><span style="color: #FFFFFF">const_iterator</span> <span style="color: #FFFFFF">ri</span>;
        <span style="color: #FF8000">for</span> ( <span style="color: #FFFFFF">ri</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">results</span>.<span style="color: #FFFFFF">begin</span>(); <span style="color: #FFFFFF">ri</span> <span style="color: #FF8000">!=</span> <span style="color: #FFFFFF">results</span>.<span style="color: #FFFFFF">end</span>(); <span style="color: #FF8000">++</span><span style="color: #FFFFFF">ri</span> ) {
            <span style="color: #FFFFFF">cout</span> <span style="color: #FF8000">&lt;&lt;</span> <span style="color: #FF8000">*</span><span style="color: #FFFFFF">ri</span> <span style="color: #FF8000">&lt;&lt;</span> <span style="color: #02FF02">&quot; &quot;</span>;
        }
        <span style="color: #FFFFFF">cout</span> <span style="color: #FF8000">&lt;&lt;</span> <span style="color: #FFFFFF">endl</span>;
        <span style="color: #FF8000">return</span>;
    }
    <span style="color: #FF8000">void</span> <span style="color: #FFFFFF">show_network</span>() {
        <span style="color: #FFFFFF">cout</span> <span style="color: #FF8000">&lt;&lt;</span> <span style="color: #02FF02">&quot;Unit network: &quot;</span>;
        <span style="color: #FFFFFF">vector</span><span style="color: #FF8000">&lt;float&gt;::</span><span style="color: #FFFFFF">const_iterator</span> <span style="color: #FFFFFF">wi</span>;
        <span style="color: #FF8000">for</span> ( <span style="color: #FFFFFF">wi</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">network</span>.<span style="color: #FFFFFF">begin</span>(); <span style="color: #FFFFFF">wi</span> <span style="color: #FF8000">!=</span> <span style="color: #FFFFFF">network</span>.<span style="color: #FFFFFF">end</span>(); <span style="color: #FF8000">++</span><span style="color: #FFFFFF">wi</span> ) {
            <span style="color: #FFFFFF">cout</span> <span style="color: #FF8000">&lt;&lt;</span> <span style="color: #FF8000">*</span><span style="color: #FFFFFF">wi</span> <span style="color: #FF8000">&lt;&lt;</span> <span style="color: #02FF02">&quot; &quot;</span>;
        }
        <span style="color: #FFFFFF">cout</span> <span style="color: #FF8000">&lt;&lt;</span> <span style="color: #FFFFFF">endl</span>;
        <span style="color: #FF8000">return</span>;
    }
};
</pre></div>
</td></tr></table>
           </div>
        </td></tr>
    </table>
  </body>
</html>
