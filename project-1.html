<!DOCTYPE html>
<html>
  <head>
    <title>Business Process Automation</title>
    <h1 style="color:#02FF02">Business Process Automation</h1>
  </head>
  <img style="width:574; height:441px" src="workflow.png" alt="workflow"/>
  <body style="background-color:#002240; color:white;">
    <h1 style="color:#02FF02">Main Processor</h1>
    <div style="width:610px; height:300px; overflow:auto; font-family:courier"> 
<table class="table"><tr><td><div class="linenodiv" style="background-color: #454545; padding-right: 10px"><pre style="line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86</pre></div></td><td class="code"><div style="background: #002240"><pre style="line-height: 125%"><span></span><span style="color: #DD0000">###########</span>
<span style="color: #DD0000"># main.py #</span>
<span style="color: #DD0000">###########</span>

<span style="color: #FF8000">from</span> <span style="color: #FFFFFF">process</span> <span style="color: #FF8000">import</span> <span style="color: #FFFFFF">Connect</span>, <span style="color: #FFFFFF">Process</span>

<span style="color: #FF8000">class</span> <span style="color: #5E5EFF">Main</span>():
    <span style="color: #FF8000">def</span> <span style="color: #5E5EFF">__init__</span>( <span style="color: #FF69B4">self</span> ) :
        <span style="color: #FFFFFF">Connect</span>()<span style="color: #FF8000">.</span><span style="color: #FFFFFF">aw</span>() <span style="color: #DD0000"># Assign DB</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">process</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">Process</span>()
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">process</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">track</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">jotdown</span>(
            <span style="color: #02FF02">&#39;External files are being loaded. &#39;</span> <span style="color: #FF8000">+</span>\
            <span style="color: #02FF02">&#39;This may take a few minutes. &#39;</span> )
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">process</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">rate_archive</span> <span style="color: #FF8000">=</span> \
            <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">process</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">query</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">master_rate_alignment</span>()
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">process</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">mail_archive</span> <span style="color: #FF8000">=</span> \
            <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">process</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">query</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">master_mail_alignment</span>()
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">process</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">reltio_rates</span> <span style="color: #FF8000">=</span> \
            <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">process</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">query</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">all_rates_master</span>()
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">process</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">track</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">logtime</span>()

    <span style="color: #FF8000">def</span> <span style="color: #5E5EFF">processor</span>( <span style="color: #FF69B4">self</span>, <span style="color: #FFFFFF">account</span>, <span style="color: #FFFFFF">analyte</span>, <span style="color: #FFFFFF">issueid</span>, <span style="color: #FFFFFF">sleep</span> <span style="color: #FF8000">=</span> <span style="color: #FF00FF">30</span> ):
        <span style="color: #02FF02">&#39;&#39;&#39;</span>
<span style="color: #02FF02">        +-------------------------------------------------+</span>
<span style="color: #02FF02">        |             Feedback File Processor             |</span>
<span style="color: #02FF02">        +-------------+-----------------------------------+</span>
<span style="color: #02FF02">        |   Argument  |            Description            |</span>
<span style="color: #02FF02">        +-------------+-----------------------------------+</span>
<span style="color: #02FF02">        | (1) account | (1) Sales Hierarchy               |</span>
<span style="color: #02FF02">        | (2) analyte | (2) Rate Program or Email Address |</span>
<span style="color: #02FF02">        | (3) issueid | (3) Incorrect/Missing Rate/Email  |</span>
<span style="color: #02FF02">        +-------------+-----------------------------------+</span>
<span style="color: #02FF02">        &#39;&#39;&#39;</span>
        <span style="color: #DD0000"># Reset timers</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">process</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">track</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">reset</span>()
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">process</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">total</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">reset</span>()
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">process</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">scrape</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">sleep</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">sleep</span>
        <span style="color: #DD0000"># Letting you know we&#39;ve started</span>
        <span style="color: #FFFFFF">log</span> <span style="color: #FF8000">=</span> <span style="color: #02FF02">&#39;Processing account {} with analyte {} ...&#39;</span>
        <span style="color: #FFFFFF">log</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">log</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">format</span>( <span style="color: #FFFFFF">account</span>, <span style="color: #FFFFFF">analyte</span> )
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">process</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">track</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">jotdown</span>( <span style="color: #FFFFFF">log</span> )
        <span style="color: #DD0000"># Commence program sequence</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">process</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">account</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">account</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">lower</span>()
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">process</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">analyte</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">analyte</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">split</span>( <span style="color: #02FF02">&#39;@&#39;</span> )[ <span style="color: #FF8000">-</span><span style="color: #FF00FF">1</span> ]
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">process</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">issueid</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">issueid</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">lower</span>()
        <span style="color: #DD0000"># Reset parameters</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">process</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">reset</span>()
        <span style="color: #DD0000"># (1) Check cache </span>
        <span style="color: #FFFFFF">cache</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">process</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">scan_cache</span>()
        <span style="color: #FF8000">if</span> <span style="color: #FFFFFF">cache</span> <span style="color: #FF8000">is</span> <span style="color: #FF8000">not</span> <span style="color: #FF69B4">None</span>: <span style="color: #FF8000">return</span> <span style="color: #FFFFFF">cache</span>
        <span style="color: #DD0000"># (2) Is analyte valid?</span>
        <span style="color: #FF8000">if</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">process</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">validation</span>() :
            <span style="color: #DD0000"># (3) Find the company that is</span>
            <span style="color: #DD0000">#     associated with the analyte</span>
            <span style="color: #FFFFFF">trash</span> <span style="color: #FF8000">=</span> [] <span style="color: #DD0000"># Avoid infinite loop</span>
            <span style="color: #FFFFFF">prnts</span> <span style="color: #FF8000">=</span> [] <span style="color: #DD0000"># parent companies</span>
            <span style="color: #FFFFFF">names</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">process</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">assoc_comp</span>()
            <span style="color: #FF8000">while</span> <span style="color: #FFFFFF">names</span> :
                <span style="color: #FFFFFF">name</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">names</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">pop</span>( <span style="color: #FF00FF">0</span> ) <span style="color: #DD0000">#LIFO queue</span>
                <span style="color: #FF8000">if</span> <span style="color: #FFFFFF">name</span> <span style="color: #FF8000">in</span> <span style="color: #FFFFFF">trash</span> :
                    <span style="color: #FF8000">continue</span> <span style="color: #DD0000"># Skip</span>
                <span style="color: #FF8000">if</span> <span style="color: #FFFFFF">name</span> <span style="color: #FF8000">in</span> <span style="color: #FFFFFF">prnts</span> :
                    <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">process</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">parents</span> <span style="color: #FF8000">=</span>  <span style="color: #FF69B4">True</span>
                <span style="color: #FF8000">else</span> :
                    <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">process</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">parents</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">False</span>
                <span style="color: #FF8000">if</span> <span style="color: #FF69B4">len</span>( <span style="color: #FFFFFF">trash</span> ) <span style="color: #FF8000">&gt;</span> <span style="color: #FF00FF">10</span> :
                    <span style="color: #FF8000">break</span> <span style="color: #DD0000"># Just give up</span>
                <span style="color: #DD0000"># (4) Search company name in AW</span>
                <span style="color: #FF8000">if</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">process</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">name_in_aw</span>( <span style="color: #FFFFFF">name</span> ) :
                    <span style="color: #DD0000"># (5) If found, link name to analyte</span>
                    <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">process</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">link_analyte</span>( <span style="color: #FFFFFF">name</span> )
                    <span style="color: #DD0000"># (6) Search account in hierarchy</span>
                    <span style="color: #FFFFFF">web</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">process</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">blowup_web</span>()
                    <span style="color: #FF8000">if</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">process</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">acnt_in_web</span>( <span style="color: #FFFFFF">web</span> ) :
                        <span style="color: #DD0000"># (7) If found, validate archive</span>
                        <span style="color: #FF8000">return</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">process</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">resolution</span>()
                <span style="color: #FFFFFF">trash</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">append</span>( <span style="color: #FFFFFF">name</span> )
                <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">process</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">parents</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">True</span>
                <span style="color: #FFFFFF">pars</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">process</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">assoc_comp</span>( <span style="color: #FFFFFF">name</span> )
                <span style="color: #FF8000">for</span> <span style="color: #FFFFFF">comp</span> <span style="color: #FF8000">in</span> <span style="color: #FFFFFF">pars</span> :
                    <span style="color: #FF8000">if</span> <span style="color: #FFFFFF">comp</span> <span style="color: #FF8000">not</span> <span style="color: #FF8000">in</span> <span style="color: #FFFFFF">prnts</span> :
                        <span style="color: #FFFFFF">prnts</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">append</span>( <span style="color: #FFFFFF">comp</span> )
                    <span style="color: #FF8000">if</span> <span style="color: #FFFFFF">comp</span> <span style="color: #FF8000">not</span> <span style="color: #FF8000">in</span> <span style="color: #FFFFFF">names</span> :
                        <span style="color: #FFFFFF">names</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">append</span>( <span style="color: #FFFFFF">comp</span> )
        <span style="color: #DD0000"># Check archive</span>
        <span style="color: #FF8000">return</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">process</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">resolution</span>()
</pre></div>
</td></tr></table>
    </div>
    <h1 style="color:#02FF02">Processes</h1>
    <div style="width:610px; height:300px; overflow:auto; font-family:courier">
      <table class="table"><tr><td><div class="linenodiv" style="background-color: #454545; padding-right: 10px"><pre style="line-height: 125%">  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524</pre></div></td><td class="code"><div style="background: #002240"><pre style="line-height: 125%"><span></span><span style="color: #DD0000">##############</span>
<span style="color: #DD0000"># process.py #</span>
<span style="color: #DD0000">##############</span>

<span style="color: #FF8000">import</span> <span style="color: #FFFFFF">fuzzywuzzy</span> <span style="color: #FF8000">as</span> <span style="color: #FFFFFF">fuzz</span><span style="color: #FF8000">,</span> <span style="color: #FFFFFF">pandas</span> <span style="color: #FF8000">as</span> <span style="color: #FFFFFF">pd</span>
<span style="color: #FF8000">from</span> <span style="color: #FFFFFF">trackingtools</span> <span style="color: #FF8000">import</span> <span style="color: #FFFFFF">Query</span>, <span style="color: #FFFFFF">Runtime</span>, <span style="color: #FFFFFF">Scrape</span>, <span style="color: #FFFFFF">Tools</span>, <span style="color: #FFFFFF">Verify</span>

<span style="color: #FF8000">class</span> <span style="color: #5E5EFF">Process</span>() :
    <span style="color: #FF8000">def</span> <span style="color: #5E5EFF">__init__</span>( <span style="color: #FF69B4">self</span> ) :
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">account</span> <span style="color: #FF8000">=</span> <span style="color: #02FF02">&#39;&#39;</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">analyte</span> <span style="color: #FF8000">=</span> <span style="color: #02FF02">&#39;&#39;</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">issueid</span> <span style="color: #FF8000">=</span> <span style="color: #02FF02">&#39;&#39;</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">resolve</span> <span style="color: #FF8000">=</span> <span style="color: #02FF02">&#39;&#39;</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">handoff</span> <span style="color: #FF8000">=</span> <span style="color: #02FF02">&#39;&#39;</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">parents</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">False</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">orphans</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">False</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">linkage</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">pd</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">Series</span>()
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">archive</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">pd</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">Series</span>()
        <span style="color: #DD0000"># Processing parameters</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">parent_title</span> <span style="color: #FF8000">=</span> <span style="color: #02FF02">&#39;&#39;</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">entity_title</span> <span style="color: #FF8000">=</span> <span style="color: #02FF02">&#39;&#39;</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">validarchive</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">False</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">analyte_arch</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">False</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">acnt_in_arch</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">False</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">acnt_in_link</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">False</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">parent_in_aw</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">False</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">entity_in_aw</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">False</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">parentresult</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">pd</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">DataFrame</span>()
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">entityresult</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">pd</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">DataFrame</span>()
        <span style="color: #DD0000"># Tracking Tools (⌐■_■)</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">track</span>  <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">Runtime</span>()
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">total</span>  <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">Runtime</span>()
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">tools</span>  <span style="color: #FF8000">=</span>   <span style="color: #FFFFFF">Tools</span>()
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">query</span>  <span style="color: #FF8000">=</span>   <span style="color: #FFFFFF">Query</span>()
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">scrape</span> <span style="color: #FF8000">=</span>  <span style="color: #FFFFFF">Scrape</span>()
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">verify</span> <span style="color: #FF8000">=</span>  <span style="color: #FFFFFF">Verify</span>()
        <span style="color: #DD0000"># Synchronizing program log</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">tools</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">track</span>  <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">track</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">query</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">track</span>  <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">track</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">scrape</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">track</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">track</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">verify</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">track</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">track</span>
        <span style="color: #DD0000"># Cache</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">links</span> <span style="color: #FF8000">=</span> {}
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">resol</span> <span style="color: #FF8000">=</span> {}
        <span style="color: #DD0000"># External files</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">rate_archive</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">pd</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">DataFrame</span>()
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">mail_archive</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">pd</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">DataFrame</span>()
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">reltio_rates</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">pd</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">DataFrame</span>()
        <span style="color: #DD0000"># Information store</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span> <span style="color: #FF8000">=</span> {
            <span style="color: #02FF02">&#39;Associated Account&#39;</span> : [], <span style="color: #02FF02">&#39;Assoc. Acc. in AW&#39;</span> : [],
            <span style="color: #02FF02">&#39;Parent Account&#39;</span>     : [], <span style="color: #02FF02">&#39;Parent Acc. in AW&#39;</span> : [],
            <span style="color: #02FF02">&#39;Found Link&#39;</span>         : [], <span style="color: #02FF02">&#39;Hierarchy&#39;</span>         : [],
            <span style="color: #02FF02">&#39;Archived Link&#39;</span>      : [], <span style="color: #02FF02">&#39;Archived Hierarchy&#39;</span>: [],
            <span style="color: #02FF02">&#39;Resolution&#39;</span>         : []
            }

    <span style="color: #FF8000">def</span> <span style="color: #5E5EFF">archived</span>( <span style="color: #FF69B4">self</span> ) :
        <span style="color: #02FF02">&#39;&#39;&#39;</span>
<span style="color: #02FF02">        Helper Function:</span>
<span style="color: #02FF02">        Search the master alignment files for</span>
<span style="color: #02FF02">        the analyte. If archived, return true.</span>
<span style="color: #02FF02">        &#39;&#39;&#39;</span>
        <span style="color: #FF8000">if</span> <span style="color: #02FF02">&#39;mail&#39;</span> <span style="color: #FF8000">in</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">issueid</span> :
            <span style="color: #FFFFFF">rate</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">False</span>
            <span style="color: #FFFFFF">colm</span> <span style="color: #FF8000">=</span> <span style="color: #02FF02">&#39;email_address_txt&#39;</span>
            <span style="color: #FFFFFF">find</span> <span style="color: #FF8000">=</span> <span style="color: #02FF02">&#39;DUNS&#39;</span>
            <span style="color: #FFFFFF">arch</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">mail_archive</span>
        <span style="color: #FF8000">if</span> <span style="color: #02FF02">&#39;rate&#39;</span> <span style="color: #FF8000">in</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">issueid</span> :
            <span style="color: #FFFFFF">rate</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">True</span>
            <span style="color: #FFFFFF">colm</span> <span style="color: #FF8000">=</span> <span style="color: #02FF02">&#39;rate_program&#39;</span>
            <span style="color: #FFFFFF">find</span> <span style="color: #FF8000">=</span> <span style="color: #02FF02">&#39;account_uri&#39;</span>
            <span style="color: #FFFFFF">arch</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">rate_archive</span>
        <span style="color: #FFFFFF">indx</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">arch</span>[ <span style="color: #FFFFFF">colm</span> ] <span style="color: #FF8000">==</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">analyte</span>
        <span style="color: #FFFFFF">slct</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">arch</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">loc</span>[ <span style="color: #FFFFFF">indx</span>, <span style="color: #FFFFFF">find</span> ]
        <span style="color: #FF8000">if</span> <span style="color: #FFFFFF">slct</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">empty</span>: <span style="color: #FF8000">return</span> <span style="color: #FF69B4">False</span>
        <span style="color: #DD0000"># Retrieve the archived links</span>
        <span style="color: #FFFFFF">colms</span> <span style="color: #FF8000">=</span> [ <span style="color: #02FF02">&#39;CHILD_URI&#39;</span>,
                  <span style="color: #02FF02">&#39;CHILD_ACCOUNT_NM&#39;</span> ] 
        <span style="color: #FFFFFF">links</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">pd</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">DataFrame</span>()
        <span style="color: #FF8000">for</span> <span style="color: #FFFFFF">uid</span> <span style="color: #FF8000">in</span> <span style="color: #FFFFFF">slct</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">unique</span>()<span style="color: #FF8000">.</span><span style="color: #FFFFFF">tolist</span>() :
            <span style="color: #FF8000">if</span> <span style="color: #FFFFFF">rate</span> :
                <span style="color: #FFFFFF">link</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">query</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">uri</span>( <span style="color: #FFFFFF">uid</span>, <span style="color: #FFFFFF">colms</span> )
            <span style="color: #FF8000">else</span> :
                <span style="color: #FFFFFF">link</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">query</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">duns</span>( <span style="color: #FFFFFF">uid</span>, <span style="color: #FFFFFF">colms</span> )
            <span style="color: #FF8000">if</span> <span style="color: #FF8000">not</span> <span style="color: #FFFFFF">link</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">empty</span> :
                <span style="color: #FFFFFF">links</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">links</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">append</span>( <span style="color: #FFFFFF">link</span> )
        <span style="color: #DD0000"># Store the archived links</span>
        <span style="color: #FF8000">for</span> <span style="color: #FFFFFF">link</span> <span style="color: #FF8000">in</span> <span style="color: #FFFFFF">links</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">values</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">tolist</span>():
            <span style="color: #FFFFFF">link</span> <span style="color: #FF8000">=</span> <span style="color: #02FF02">&#39;, &#39;</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">join</span>( <span style="color: #FFFFFF">link</span> )
            <span style="color: #FF8000">if</span> <span style="color: #FFFFFF">link</span> <span style="color: #FF8000">not</span> <span style="color: #FF8000">in</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span>[ <span style="color: #02FF02">&#39;Archived Link&#39;</span> ] :
                <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span>[ <span style="color: #02FF02">&#39;Archived Link&#39;</span> ]<span style="color: #FF8000">.</span><span style="color: #FFFFFF">append</span>( <span style="color: #FFFFFF">link</span> )
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">handoff</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">links</span>
        <span style="color: #FF8000">return</span> <span style="color: #FF69B4">True</span>

    <span style="color: #FF8000">def</span> <span style="color: #5E5EFF">valid_archive</span>( <span style="color: #FF69B4">self</span> ) :
        <span style="color: #02FF02">&#39;&#39;&#39;</span>
<span style="color: #02FF02">        Helper Function:</span>
<span style="color: #02FF02">        Validate the archived analyte linkage</span>
<span style="color: #02FF02">        by searching the found linkage in the</span>
<span style="color: #02FF02">        archived hierarchy.</span>
<span style="color: #02FF02">        &#39;&#39;&#39;</span>
        <span style="color: #FFFFFF">arch</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">handoff</span> <span style="color: #DD0000"># from archived</span>
        <span style="color: #FF8000">if</span> <span style="color: #FFFFFF">arch</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">empty</span>: <span style="color: #DD0000"># Not found in AW</span>
            <span style="color: #FFFFFF">log</span>  <span style="color: #FF8000">=</span> <span style="color: #02FF02">&#39;Archived D-U-N-S or URI not found in AW&#39;</span>
            <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span>[ <span style="color: #02FF02">&#39;Archived Hierarchy&#39;</span> ]<span style="color: #FF8000">.</span><span style="color: #FFFFFF">append</span>( <span style="color: #FFFFFF">log</span> )
            <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span>[ <span style="color: #02FF02">&#39;Archived Link&#39;</span>      ]<span style="color: #FF8000">.</span><span style="color: #FFFFFF">append</span>( <span style="color: #FFFFFF">log</span> )
            <span style="color: #FFFFFF">log</span> <span style="color: #FF8000">+=</span> <span style="color: #02FF02">&quot;. Can&#39;t validate the archived link.&quot;</span>
            <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">track</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">jotdown</span>( <span style="color: #FFFFFF">log</span> )
            <span style="color: #FF8000">return</span> <span style="color: #FF69B4">False</span>
        <span style="color: #DD0000"># Blow up hierarchy</span>
        <span style="color: #FF8000">for</span> <span style="color: #FFFFFF">indx</span>, <span style="color: #FFFFFF">series</span> <span style="color: #FF8000">in</span> <span style="color: #FFFFFF">arch</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">iterrows</span>() :
            <span style="color: #FFFFFF">uri</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">series</span>[ <span style="color: #02FF02">&#39;CHILD_URI&#39;</span> ]
            <span style="color: #FFFFFF">web</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">query</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">blowup</span>( <span style="color: #FFFFFF">uri</span>, <span style="color: #FFFFFF">uri</span>  <span style="color: #FF8000">=</span> <span style="color: #FF69B4">True</span>,
                                     <span style="color: #FFFFFF">only_duns</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">True</span> )
            <span style="color: #DD0000"># Store archived hierarchy</span>
            <span style="color: #FFFFFF">ultm</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">query</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">ultm</span>
            <span style="color: #FF8000">for</span> <span style="color: #FFFFFF">ultm</span> <span style="color: #FF8000">in</span> <span style="color: #FFFFFF">ultm</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">values</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">tolist</span>() :
                <span style="color: #FFFFFF">join</span> <span style="color: #FF8000">=</span> <span style="color: #02FF02">&#39;, &#39;</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">join</span>( <span style="color: #FFFFFF">ultm</span> )
                <span style="color: #FF8000">if</span> <span style="color: #FFFFFF">join</span> <span style="color: #FF8000">not</span> <span style="color: #FF8000">in</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span>[ <span style="color: #02FF02">&#39;Archived Hierarchy&#39;</span> ] :
                    <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span>[ <span style="color: #02FF02">&#39;Archived Hierarchy&#39;</span> ]<span style="color: #FF8000">.</span><span style="color: #FFFFFF">append</span>( <span style="color: #FFFFFF">join</span> )
            <span style="color: #DD0000"># Search the D-U-N-S number of the</span>
            <span style="color: #DD0000"># linkage in the archived hierarchy</span>
            <span style="color: #FF8000">if</span> <span style="color: #FF8000">not</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">linkage</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">empty</span>:
                <span style="color: #FFFFFF">link</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">linkage</span>
                <span style="color: #FFFFFF">colm</span> <span style="color: #FF8000">=</span> [ <span style="color: #FFFFFF">col</span> <span style="color: #FF8000">for</span> <span style="color: #FFFFFF">col</span> <span style="color: #FF8000">in</span> <span style="color: #FFFFFF">link</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">index</span> <span style="color: #FF8000">if</span> <span style="color: #02FF02">&#39;DUNS&#39;</span> <span style="color: #FF8000">in</span> <span style="color: #FFFFFF">col</span> ]
                <span style="color: #FFFFFF">duns</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">link</span>[ <span style="color: #FFFFFF">colm</span> ]<span style="color: #FF8000">.</span><span style="color: #FFFFFF">iloc</span>[ <span style="color: #FF00FF">0</span> ]
                <span style="color: #FF8000">if</span> <span style="color: #FFFFFF">duns</span> <span style="color: #FF8000">!=</span> <span style="color: #02FF02">&#39;&#39;</span> :
                    <span style="color: #FF8000">if</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">tools</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">duns_in_web</span>( <span style="color: #FFFFFF">duns</span>, <span style="color: #FFFFFF">web</span> ) :
                        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">archive</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">series</span>
                        <span style="color: #DD0000"># Search acnt in archived hierarchy</span>
                        <span style="color: #FF8000">if</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">tools</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">acnt_in_web</span>( <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">account</span>, <span style="color: #FFFFFF">web</span> ) :
                            <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">acnt_in_arch</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">True</span>
                        <span style="color: #FF8000">else</span> :
                            <span style="color: #DD0000"># To account for orphans, search all the</span>
                            <span style="color: #DD0000"># company names in the archived hierarchy</span>
                            <span style="color: #FF8000">for</span> <span style="color: #FFFFFF">name</span> <span style="color: #FF8000">in</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span>[ <span style="color: #02FF02">&#39;Associated Account&#39;</span> ] :
                                <span style="color: #FF8000">if</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">tools</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">acnt_in_web</span>( <span style="color: #FFFFFF">name</span>, <span style="color: #FFFFFF">web</span> ) :
                                    <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">orphans</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">True</span>
                        <span style="color: #FF8000">return</span> <span style="color: #FF69B4">True</span>
            <span style="color: #DD0000"># Search acnt in archived hierarchy</span>
            <span style="color: #FF8000">if</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">tools</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">acnt_in_web</span>( <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">account</span>, <span style="color: #FFFFFF">web</span> ) :
                <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">archive</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">series</span>
                <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">acnt_in_arch</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">True</span>
                <span style="color: #FF8000">return</span> <span style="color: #FF69B4">True</span>
            <span style="color: #DD0000"># To account for orphans, search all the</span>
            <span style="color: #DD0000"># company names in the archived hierarchy</span>
            <span style="color: #FF8000">for</span> <span style="color: #FFFFFF">name</span> <span style="color: #FF8000">in</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span>[ <span style="color: #02FF02">&#39;Associated Account&#39;</span> ] :
                <span style="color: #FF8000">if</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">tools</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">acnt_in_web</span>( <span style="color: #FFFFFF">name</span>, <span style="color: #FFFFFF">web</span> ) :
                    <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">archive</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">series</span>
                    <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">orphans</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">True</span>
                    <span style="color: #FF8000">return</span> <span style="color: #FF69B4">True</span>
        <span style="color: #DD0000"># If no link was found,</span>
        <span style="color: #DD0000"># just take what&#39;s archived</span>
        <span style="color: #FF8000">if</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">linkage</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">empty</span> :
            <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">archive</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">arch</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">iloc</span>[ <span style="color: #FF00FF">0</span> ]
            <span style="color: #FF8000">return</span> <span style="color: #FF69B4">True</span>
        <span style="color: #FF8000">return</span> <span style="color: #FF69B4">False</span>

    <span style="color: #FF8000">def</span> <span style="color: #5E5EFF">validate_archive</span>( <span style="color: #FF69B4">self</span> ) :
        <span style="color: #02FF02">&#39;&#39;&#39;</span>
<span style="color: #02FF02">        Helper Function:</span>
<span style="color: #02FF02">        Attempts to validate archived. If the</span>
<span style="color: #02FF02">        archived link can&#39;t be validated, the</span>
<span style="color: #02FF02">        archive is assumed to be valid.</span>
<span style="color: #02FF02">        &#39;&#39;&#39;</span>
        <span style="color: #DD0000"># Search archive for analyte</span>
        <span style="color: #FF8000">if</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">archived</span>() :
            <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">analyte_arch</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">True</span>
            <span style="color: #DD0000"># Validate archive</span>
            <span style="color: #FF8000">if</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">valid_archive</span>() :
                <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">validarchive</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">True</span>

    <span style="color: #FF8000">def</span> <span style="color: #5E5EFF">has_duns</span>( <span style="color: #FF69B4">self</span> ) :
        <span style="color: #FFFFFF">link</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">linkage</span>
        <span style="color: #FF8000">for</span> <span style="color: #FFFFFF">col</span> <span style="color: #FF8000">in</span> <span style="color: #FFFFFF">link</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">index</span> :
            <span style="color: #FF8000">if</span> <span style="color: #02FF02">&#39;DUNS&#39;</span> <span style="color: #FF8000">in</span> <span style="color: #FFFFFF">col</span> :
                <span style="color: #FFFFFF">colm</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">col</span>
                <span style="color: #FF8000">break</span>
        <span style="color: #FFFFFF">duns</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">link</span>[ <span style="color: #FFFFFF">colm</span> ]
        <span style="color: #FF8000">if</span> <span style="color: #FFFFFF">duns</span> : <span style="color: #FF8000">return</span> <span style="color: #FF69B4">True</span>
        <span style="color: #FF8000">return</span> <span style="color: #FF69B4">False</span>

    <span style="color: #FF8000">def</span> <span style="color: #5E5EFF">find_linkage</span>( <span style="color: #FF69B4">self</span> ) :
        <span style="color: #02FF02">&#39;&#39;&#39;</span>
<span style="color: #02FF02">        Helper Function:</span>
<span style="color: #02FF02">        If an organization was found in AW DB,</span>
<span style="color: #02FF02">        then link analyte to the lowest level</span>
<span style="color: #02FF02">        account. Then, provide the resolution.</span>
<span style="color: #02FF02">        &#39;&#39;&#39;</span>
        <span style="color: #FF8000">if</span> <span style="color: #FF8000">not</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">archive</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">empty</span> :
            <span style="color: #DD0000"># Archive is valid</span>
            <span style="color: #FF8000">if</span> <span style="color: #02FF02">&#39;incorrect&#39;</span> <span style="color: #FF8000">in</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">issueid</span> :
                <span style="color: #FF8000">if</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">linkage</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">empty</span> :
                    <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">resolve</span> <span style="color: #FF8000">=</span> <span style="color: #02FF02">&#39;Program Could Not Validate&#39;</span>
                    <span style="color: #FF8000">return</span>
            <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">linkage</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">archive</span>
            <span style="color: #FF8000">if</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">acnt_in_arch</span> :
                <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">resolve</span> <span style="color: #FF8000">=</span> <span style="color: #02FF02">&#39;Deny - Correctly Linked&#39;</span>
                <span style="color: #FF8000">if</span> <span style="color: #FF69B4">len</span>( <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span>[ <span style="color: #02FF02">&#39;Hierarchy&#39;</span> ] ) <span style="color: #FF8000">&gt;</span> <span style="color: #FF00FF">1</span> :
                    <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">resolve</span> <span style="color: #FF8000">+=</span> <span style="color: #02FF02">&#39; - Broken Hierarchy&#39;</span> 
            <span style="color: #FF8000">elif</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">acnt_in_link</span> :
                <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">resolve</span> <span style="color: #FF8000">=</span> <span style="color: #02FF02">&#39;Approved&#39;</span>
                <span style="color: #FF8000">if</span> <span style="color: #FF69B4">len</span>( <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span>[ <span style="color: #02FF02">&#39;Hierarchy&#39;</span> ] ) <span style="color: #FF8000">&gt;</span> <span style="color: #FF00FF">1</span> :
                    <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">resolve</span> <span style="color: #FF8000">+=</span> <span style="color: #02FF02">&#39; - Broken Hierarchy&#39;</span> 
            <span style="color: #FF8000">else</span> :
                <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">resolve</span> <span style="color: #FF8000">=</span> <span style="color: #02FF02">&#39;Deny - Different Hierarchy&#39;</span>
        <span style="color: #FF8000">elif</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">acnt_in_link</span> :
            <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">resolve</span> <span style="color: #FF8000">=</span> <span style="color: #02FF02">&#39;Approved&#39;</span>
            <span style="color: #FF8000">if</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">entity_in_aw</span> :
                <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">handoff</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">entityresult</span>
                <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">link_analyte</span>( <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">entity_title</span> )
                <span style="color: #FF8000">if</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">parent_in_aw</span> :
                    <span style="color: #FF8000">if</span> <span style="color: #FF8000">not</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">has_duns</span>() :
                        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">handoff</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">parentresult</span>
                        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">link_analyte</span>( <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">parent_title</span> )
            <span style="color: #FF8000">elif</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">parent_in_aw</span> :
                <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">handoff</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">parentresult</span>
                <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">link_analyte</span>( <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">parent_title</span> )
            <span style="color: #FF8000">if</span> <span style="color: #FF69B4">len</span>( <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span>[ <span style="color: #02FF02">&#39;Hierarchy&#39;</span> ] ) <span style="color: #FF8000">&gt;</span> <span style="color: #FF00FF">1</span> :
                <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">resolve</span> <span style="color: #FF8000">+=</span> <span style="color: #02FF02">&#39; - Broken Hierarchy&#39;</span>
        <span style="color: #FF8000">elif</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">entity_in_aw</span> <span style="color: #FF8000">or</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">parent_in_aw</span> :
            <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">resolve</span> <span style="color: #FF8000">=</span> <span style="color: #02FF02">&#39;Deny - Different Hierarchy&#39;</span>
            <span style="color: #FF8000">if</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">entity_in_aw</span> :
                <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">handoff</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">entityresult</span>
                <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">link_analyte</span>( <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">entity_title</span> )
            <span style="color: #FF8000">elif</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">parent_in_aw</span> :
                <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">handoff</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">parentresult</span>
                <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">link_analyte</span>( <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">parent_title</span> )
        <span style="color: #FF8000">if</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">analyte_arch</span> <span style="color: #FF8000">and</span> <span style="color: #FF8000">not</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">validarchive</span> :
            <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">resolve</span> <span style="color: #FF8000">+=</span> <span style="color: #02FF02">&#39; - Delete &amp; Relink&#39;</span>
        
    <span style="color: #FF8000">def</span> <span style="color: #5E5EFF">link_duns</span>( <span style="color: #FF69B4">self</span> ) :
        <span style="color: #02FF02">&#39;&#39;&#39;</span>
<span style="color: #02FF02">        Helper Function:</span>
<span style="color: #02FF02">        If linked account in AW does not have</span>
<span style="color: #02FF02">        a D-U-N-S number, link the analyte to</span>
<span style="color: #02FF02">        the ultimate parent account, instead.</span>
<span style="color: #02FF02">        &#39;&#39;&#39;</span>
        <span style="color: #FFFFFF">link</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">linkage</span>
        <span style="color: #FF8000">for</span> <span style="color: #FFFFFF">col</span> <span style="color: #FF8000">in</span> <span style="color: #FFFFFF">link</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">index</span> :
            <span style="color: #FF8000">if</span> <span style="color: #02FF02">&#39;DUNS&#39;</span> <span style="color: #FF8000">in</span> <span style="color: #FFFFFF">col</span> :
                <span style="color: #FFFFFF">colm</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">col</span>
                <span style="color: #FF8000">break</span>
        <span style="color: #FFFFFF">duns</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">link</span>[ <span style="color: #FFFFFF">colm</span> ]
        <span style="color: #FF8000">for</span> <span style="color: #FFFFFF">col</span> <span style="color: #FF8000">in</span> <span style="color: #FFFFFF">link</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">index</span> :
            <span style="color: #FF8000">if</span> <span style="color: #02FF02">&#39;URI&#39;</span> <span style="color: #FF8000">in</span> <span style="color: #FFFFFF">col</span> :
                <span style="color: #FFFFFF">colm</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">col</span>
                <span style="color: #FF8000">break</span>
        <span style="color: #FFFFFF">auri</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">link</span>[ <span style="color: #FFFFFF">colm</span> ]
        <span style="color: #FF8000">if</span> <span style="color: #FF8000">not</span> <span style="color: #FFFFFF">duns</span> :
            <span style="color: #FFFFFF">link</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">query</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">ult_acnt</span>( <span style="color: #FFFFFF">auri</span>, <span style="color: #FFFFFF">uri</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">True</span> )
            <span style="color: #FF8000">if</span> <span style="color: #FF8000">not</span> <span style="color: #FFFFFF">link</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">empty</span> :
                <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">linkage</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">link</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">iloc</span>[ <span style="color: #FF00FF">0</span> ]

    <span style="color: #FF8000">def</span> <span style="color: #5E5EFF">scan_cache</span>( <span style="color: #FF69B4">self</span> ) :
        <span style="color: #02FF02">&#39;&#39;&#39;</span>
<span style="color: #02FF02">        First Step: Check the cache to see if</span>
<span style="color: #02FF02">        data point has already been processed.</span>
<span style="color: #02FF02">        &#39;&#39;&#39;</span>
        <span style="color: #FF8000">if</span> ( <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">account</span>,
             <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">analyte</span>,
             <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">issueid</span> ) <span style="color: #FF8000">in</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">links</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">keys</span>() :
             <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">linkage</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">links</span>[ ( <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">account</span>,
                                          <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">analyte</span>,
                                          <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">issueid</span> ) ]
             <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">resolve</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">resol</span>[ ( <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">account</span>,
                                          <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">analyte</span>,
                                          <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">issueid</span> ) ]
             <span style="color: #DD0000"># Finalize information store</span>
             <span style="color: #FF8000">for</span> <span style="color: #FFFFFF">key</span> <span style="color: #FF8000">in</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">keys</span>():
                 <span style="color: #FFFFFF">val</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span>[ <span style="color: #FFFFFF">key</span> ]
                 <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span>[ <span style="color: #FFFFFF">key</span> ] <span style="color: #FF8000">=</span> <span style="color: #02FF02">&#39; | &#39;</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">join</span>( <span style="color: #FFFFFF">val</span> )
             <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span>[ <span style="color: #02FF02">&#39;Resolution&#39;</span> ] <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">resolve</span>
             <span style="color: #FFFFFF">pd</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">set_option</span>( <span style="color: #02FF02">&#39;display.max_colwidth&#39;</span>, <span style="color: #FF00FF">10000</span> )
             <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">pd</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">DataFrame</span>(
                 <span style="color: #FFFFFF">index</span>   <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">keys</span>(),
                 <span style="color: #FFFFFF">data</span>    <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">values</span>(),
                 <span style="color: #FFFFFF">columns</span> <span style="color: #FF8000">=</span> [ <span style="color: #02FF02">&#39;Info&#39;</span> ] )
             <span style="color: #DD0000"># End</span>
             <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">track</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">clear</span>()
             <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">total</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">logtime</span>()
             <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">total</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">endpage</span>()
             <span style="color: #FF8000">return</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">resolve</span>
        <span style="color: #DD0000"># If not found,</span>
        <span style="color: #FF8000">return</span>

    <span style="color: #FF8000">def</span> <span style="color: #5E5EFF">validation</span>( <span style="color: #FF69B4">self</span> ) :
        <span style="color: #02FF02">&#39;&#39;&#39;</span>
<span style="color: #02FF02">        Second Step: Validate Rate Program by</span>
<span style="color: #02FF02">        Finding it in Reltio, or Validate the</span>
<span style="color: #02FF02">        Domain by Querying its MX Records.</span>
<span style="color: #02FF02">        &#39;&#39;&#39;</span>
        <span style="color: #FF8000">if</span> <span style="color: #02FF02">&#39;mail&#39;</span> <span style="color: #FF8000">in</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">issueid</span> :
            <span style="color: #FF8000">if</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">verify</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">valid_domain</span>( <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">analyte</span> ) :
                <span style="color: #FF8000">return</span> <span style="color: #FF69B4">True</span>
            <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">resolve</span> <span style="color: #FF8000">=</span> <span style="color: #02FF02">&#39;Deny - Invalid Email Address&#39;</span>
            <span style="color: #FF8000">return</span> <span style="color: #FF69B4">False</span>
        <span style="color: #FF8000">if</span> <span style="color: #02FF02">&#39;rate&#39;</span> <span style="color: #FF8000">in</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">issueid</span> :
            <span style="color: #FF8000">if</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">tools</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">valid_program</span>( <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">analyte</span>,
                                    <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">reltio_rates</span> ) :
                <span style="color: #FF8000">return</span> <span style="color: #FF69B4">True</span>
            <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">resolve</span> <span style="color: #FF8000">=</span> <span style="color: #02FF02">&#39;Pending - Rate not Found in &#39;</span> <span style="color: #FF8000">+</span>\
                           <span style="color: #02FF02">&#39;Current Source HPP Data. &#39;</span>    <span style="color: #FF8000">+</span>\
                           <span style="color: #02FF02">&#39;DSR will Revisit this Item.&#39;</span>
            <span style="color: #FF8000">return</span> <span style="color: #FF69B4">False</span>
        <span style="color: #FF8000">raise</span> <span style="color: #FFFFFF">ValueError</span>(
            <span style="color: #02FF02">&#39;The positional argument &quot;issueid&quot; must be &#39;</span> <span style="color: #FF8000">+</span>\
            <span style="color: #02FF02">&#39;of type string containing &quot;rate&quot; or &quot;mail.&quot;&#39;</span> )

    <span style="color: #FF8000">def</span> <span style="color: #5E5EFF">assoc_comp</span>( <span style="color: #FF69B4">self</span>, <span style="color: #FFFFFF">name</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">None</span> ):
        <span style="color: #02FF02">&#39;&#39;&#39;</span>
<span style="color: #02FF02">        Third Step: Search and Seize the Name</span>
<span style="color: #02FF02">        of the Organization that&#39;s Associated</span>
<span style="color: #02FF02">        with the Analyte.</span>
<span style="color: #02FF02">        &#39;&#39;&#39;</span>
        <span style="color: #FF8000">if</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">parents</span> :
            <span style="color: #FFFFFF">comps</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">scrape</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">parent_org</span>( <span style="color: #FFFFFF">name</span> )
        <span style="color: #FF8000">elif</span> <span style="color: #02FF02">&#39;mail&#39;</span> <span style="color: #FF8000">in</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">issueid</span> :
            <span style="color: #FFFFFF">comps</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">scrape</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">assoc_comp</span>( <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">analyte</span> )
            <span style="color: #FF8000">if</span> <span style="color: #FF8000">not</span> <span style="color: #FFFFFF">comps</span> :
                <span style="color: #FFFFFF">comps</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">append</span>( <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">analyte</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">split</span>( <span style="color: #02FF02">&#39;.&#39;</span> )[ <span style="color: #FF00FF">0</span> ] )
                <span style="color: #FFFFFF">comps</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">append</span>( <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">analyte</span> )
        <span style="color: #FF8000">elif</span> <span style="color: #02FF02">&#39;rate&#39;</span> <span style="color: #FF8000">in</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">issueid</span> :
            <span style="color: #FFFFFF">comps</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">tools</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">handoff</span> <span style="color: #DD0000"># From valid_program</span>
        <span style="color: #FF8000">if</span> <span style="color: #FF69B4">len</span>( <span style="color: #FFFFFF">comps</span> ) <span style="color: #FF8000">&gt;</span> <span style="color: #FF00FF">5</span> :
            <span style="color: #DD0000"># Don&#39;t want to spend an hour here</span>
            <span style="color: #FFFFFF">comps</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">comps</span>[ <span style="color: #FF00FF">0</span> : <span style="color: #FF00FF">5</span> ]
        <span style="color: #FF8000">for</span> <span style="color: #FFFFFF">acnt</span> <span style="color: #FF8000">in</span> <span style="color: #FFFFFF">comps</span> :
            <span style="color: #FF8000">if</span> <span style="color: #FFFFFF">fuzz</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">QRatio</span>( <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">account</span>, <span style="color: #FFFFFF">acnt</span> ) <span style="color: #FF8000">!=</span> <span style="color: #FF00FF">100</span> :
                <span style="color: #DD0000"># Correct for minor mispellings</span>
                <span style="color: #FF8000">if</span> <span style="color: #FFFFFF">fuzz</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">QRatio</span>( <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">account</span>, <span style="color: #FFFFFF">acnt</span> ) <span style="color: #FF8000">&gt;=</span> <span style="color: #FF00FF">90</span> :
                    <span style="color: #FFFFFF">comps</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">append</span>( <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">account</span> )
                    <span style="color: #FF8000">break</span>
        <span style="color: #FF8000">if</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">parents</span> :
            <span style="color: #FF8000">for</span> <span style="color: #FFFFFF">name</span> <span style="color: #FF8000">in</span> <span style="color: #FFFFFF">comps</span> :
                <span style="color: #FF8000">if</span> <span style="color: #FFFFFF">name</span> <span style="color: #FF8000">not</span> <span style="color: #FF8000">in</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span>[ <span style="color: #02FF02">&#39;Parent Account&#39;</span> ] :
                    <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span>[ <span style="color: #02FF02">&#39;Parent Account&#39;</span> ]<span style="color: #FF8000">.</span><span style="color: #FFFFFF">append</span>( <span style="color: #FFFFFF">name</span> )
        <span style="color: #FF8000">else</span> :
            <span style="color: #FF8000">for</span> <span style="color: #FFFFFF">name</span> <span style="color: #FF8000">in</span> <span style="color: #FFFFFF">comps</span> :
                <span style="color: #FF8000">if</span> <span style="color: #FFFFFF">name</span> <span style="color: #FF8000">not</span> <span style="color: #FF8000">in</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span>[ <span style="color: #02FF02">&#39;Associated Account&#39;</span> ] :
                    <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span>[ <span style="color: #02FF02">&#39;Associated Account&#39;</span> ]<span style="color: #FF8000">.</span><span style="color: #FFFFFF">append</span>( <span style="color: #FFFFFF">name</span> )
        <span style="color: #FF8000">return</span> <span style="color: #FFFFFF">comps</span>

    <span style="color: #FF8000">def</span> <span style="color: #5E5EFF">name_in_aw</span>( <span style="color: #FF69B4">self</span>, <span style="color: #FFFFFF">name</span> ) :
        <span style="color: #02FF02">&#39;&#39;&#39;</span>
<span style="color: #02FF02">        Fourth Step: Query name in AW to find</span>
<span style="color: #02FF02">        whether it exists in the database.</span>
<span style="color: #02FF02">        &#39;&#39;&#39;</span>
        <span style="color: #DD0000"># Avoid querying small substrings</span>
        <span style="color: #FF8000">if</span> <span style="color: #FF69B4">len</span>( <span style="color: #FFFFFF">name</span> ) <span style="color: #FF8000">&gt;</span>  <span style="color: #FF00FF">6</span> : <span style="color: #FFFFFF">suff</span> <span style="color: #FF8000">=</span>  <span style="color: #FF69B4">True</span>
        <span style="color: #FF8000">else</span>                : <span style="color: #FFFFFF">suff</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">False</span>
        <span style="color: #FF8000">if</span> <span style="color: #FF69B4">len</span>( <span style="color: #FFFFFF">name</span> ) <span style="color: #FF8000">&gt;</span> <span style="color: #FF00FF">14</span> : <span style="color: #FFFFFF">like</span> <span style="color: #FF8000">=</span>  <span style="color: #FF69B4">True</span>
        <span style="color: #FF8000">else</span>                : <span style="color: #FFFFFF">like</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">False</span>
        <span style="color: #DD0000"># A common error is to not include</span>
        <span style="color: #DD0000"># spaces or include unnecessary spaces</span>
        <span style="color: #FFFFFF">name</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">name</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">replace</span>( <span style="color: #02FF02">&#39; &#39;</span>, <span style="color: #02FF02">&#39;&#39;</span> )
        <span style="color: #FF8000">if</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">query</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">acnt_in_db</span>( <span style="color: #FFFFFF">name</span>, <span style="color: #FFFFFF">like</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">like</span>,
                                  <span style="color: #FFFFFF">suffix</span>  <span style="color: #FF8000">=</span>  <span style="color: #FFFFFF">suff</span>,
                                  <span style="color: #FFFFFF">spaces</span>  <span style="color: #FF8000">=</span> <span style="color: #FF69B4">False</span>,
                                  <span style="color: #FFFFFF">orphans</span> <span style="color: #FF8000">=</span>  <span style="color: #FF69B4">True</span> ) :
            <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">handoff</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">query</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">handoff</span>
            <span style="color: #FFFFFF">cols</span> <span style="color: #FF8000">=</span> [ <span style="color: #FFFFFF">col</span> <span style="color: #FF8000">for</span> <span style="color: #FFFFFF">col</span>
                     <span style="color: #FF8000">in</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">handoff</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">columns</span>
                     <span style="color: #FF8000">if</span> <span style="color: #02FF02">&#39;DUNS&#39;</span> <span style="color: #FF8000">in</span> <span style="color: #FFFFFF">col</span> ]
            <span style="color: #FFFFFF">duns</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">handoff</span>[ <span style="color: #FFFFFF">cols</span> ]
            <span style="color: #FFFFFF">duns</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">duns</span> <span style="color: #FF8000">!=</span> <span style="color: #02FF02">&#39;&#39;</span>
            <span style="color: #FFFFFF">duns</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">duns</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">any</span>( <span style="color: #FFFFFF">axis</span> <span style="color: #FF8000">=</span> <span style="color: #FF00FF">1</span> )
            <span style="color: #FF8000">if</span> <span style="color: #FF8000">not</span> <span style="color: #FFFFFF">duns</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">any</span>( <span style="color: #FFFFFF">axis</span> <span style="color: #FF8000">=</span> <span style="color: #FF00FF">0</span> ) :
                <span style="color: #DD0000"># Accounts not at all associated with</span>
                <span style="color: #DD0000"># a D-U-N-S number are not reliable</span>
                <span style="color: #FF8000">return</span> <span style="color: #FF69B4">False</span>
            <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">handoff</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">handoff</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">loc</span>[
                <span style="color: #FFFFFF">duns</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">index</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">tolist</span>(), : ]
            <span style="color: #FF8000">if</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">parents</span> :
                <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">parent_in_aw</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">True</span>
                <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">parentresult</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">handoff</span>
                <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">parent_title</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">name</span>
            <span style="color: #FF8000">else</span> :
                <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">entity_in_aw</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">True</span>
                <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">entityresult</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">handoff</span>
                <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">entity_title</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">name</span>   
            <span style="color: #FF8000">return</span> <span style="color: #FF69B4">True</span>
        <span style="color: #DD0000"># Not in AW</span>
        <span style="color: #FF8000">return</span> <span style="color: #FF69B4">False</span>

    <span style="color: #FF8000">def</span> <span style="color: #5E5EFF">link_analyte</span>( <span style="color: #FF69B4">self</span>, <span style="color: #FFFFFF">name</span> ):
        <span style="color: #02FF02">&#39;&#39;&#39;</span>
<span style="color: #02FF02">        Fifth Step: Link analyte to best name</span>
<span style="color: #02FF02">        match in AW at the highest level</span>
<span style="color: #02FF02">        &#39;&#39;&#39;</span>
        <span style="color: #FFFFFF">name</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">name</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">replace</span>( <span style="color: #02FF02">&#39; &#39;</span>, <span style="color: #02FF02">&#39;&#39;</span> )
        <span style="color: #FFFFFF">query</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">handoff</span>
        <span style="color: #FFFFFF">link</span>  <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">tools</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">lowest_level_deduped</span>(
            <span style="color: #FFFFFF">name</span>, <span style="color: #FFFFFF">query</span>, <span style="color: #FFFFFF">spaces</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">False</span>
            )
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">linkage</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">link</span>

    <span style="color: #FF8000">def</span> <span style="color: #5E5EFF">blowup_web</span>( <span style="color: #FF69B4">self</span> ) :
        <span style="color: #02FF02">&#39;&#39;&#39;</span>
<span style="color: #02FF02">        Sixth Step: Blowup sales hierarchy of</span>
<span style="color: #02FF02">        the linked organization name</span>
<span style="color: #02FF02">        &#39;&#39;&#39;</span>
        <span style="color: #FFFFFF">link</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">linkage</span>
        <span style="color: #DD0000"># Retrieve name as it is written in AW</span>
        <span style="color: #FF8000">for</span> <span style="color: #FFFFFF">col</span> <span style="color: #FF8000">in</span> <span style="color: #FFFFFF">link</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">index</span> :
            <span style="color: #FF8000">if</span> <span style="color: #02FF02">&#39;NM&#39;</span> <span style="color: #FF8000">in</span> <span style="color: #FFFFFF">col</span> :
                <span style="color: #FFFFFF">colm</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">col</span>
                <span style="color: #FF8000">break</span>
        <span style="color: #FFFFFF">acnt</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">link</span>[ <span style="color: #FFFFFF">colm</span> ]
        <span style="color: #DD0000"># Store name</span>
        <span style="color: #FF8000">if</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">parents</span> :
            <span style="color: #FF8000">if</span> <span style="color: #FFFFFF">acnt</span> <span style="color: #FF8000">not</span> <span style="color: #FF8000">in</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span>[ <span style="color: #02FF02">&#39;Parent Acc. in AW&#39;</span> ] :
                <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span>[ <span style="color: #02FF02">&#39;Parent Acc. in AW&#39;</span> ]<span style="color: #FF8000">.</span><span style="color: #FFFFFF">append</span>( <span style="color: #FFFFFF">acnt</span> )
        <span style="color: #FF8000">else</span> :
            <span style="color: #FF8000">if</span> <span style="color: #FFFFFF">acnt</span> <span style="color: #FF8000">not</span> <span style="color: #FF8000">in</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span>[ <span style="color: #02FF02">&#39;Assoc. Acc. in AW&#39;</span> ]:
                <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span>[ <span style="color: #02FF02">&#39;Assoc. Acc. in AW&#39;</span> ]<span style="color: #FF8000">.</span><span style="color: #FFFFFF">append</span>( <span style="color: #FFFFFF">acnt</span> )
        <span style="color: #DD0000"># Blow up hierarchy</span>
        <span style="color: #FFFFFF">web</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">query</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">blowup</span>( <span style="color: #FFFFFF">acnt</span>, <span style="color: #FFFFFF">only_duns</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">True</span>,
                                 <span style="color: #FFFFFF">orphans</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">True</span> )
        <span style="color: #DD0000"># Store hierarchy</span>
        <span style="color: #FF8000">for</span> <span style="color: #FFFFFF">ultm</span> <span style="color: #FF8000">in</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">query</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">ultm</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">values</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">tolist</span>():
            <span style="color: #FFFFFF">ultm</span> <span style="color: #FF8000">=</span> <span style="color: #02FF02">&#39;, &#39;</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">join</span>( <span style="color: #FFFFFF">ultm</span> )
            <span style="color: #FF8000">if</span> <span style="color: #FFFFFF">ultm</span> <span style="color: #FF8000">not</span> <span style="color: #FF8000">in</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span>[ <span style="color: #02FF02">&#39;Hierarchy&#39;</span> ] :
                <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span>[ <span style="color: #02FF02">&#39;Hierarchy&#39;</span> ]<span style="color: #FF8000">.</span><span style="color: #FFFFFF">append</span>( <span style="color: #FFFFFF">ultm</span> )
        <span style="color: #FF8000">return</span> <span style="color: #FFFFFF">web</span>

    <span style="color: #FF8000">def</span> <span style="color: #5E5EFF">acnt_in_web</span>( <span style="color: #FF69B4">self</span>, <span style="color: #FFFFFF">web</span> ) :
        <span style="color: #02FF02">&#39;&#39;&#39;</span>
<span style="color: #02FF02">        Seventh Step: Search the account name</span>
<span style="color: #02FF02">        in the sales hierarchy of linked name.</span>
<span style="color: #02FF02">        Web is short for hierarchy.</span>
<span style="color: #02FF02">        &#39;&#39;&#39;</span>
        <span style="color: #FF8000">if</span> <span style="color: #FFFFFF">web</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">empty</span> : <span style="color: #FF8000">return</span> <span style="color: #FF69B4">False</span>
        <span style="color: #FFFFFF">name</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">account</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">replace</span>( <span style="color: #02FF02">&#39; &#39;</span>, <span style="color: #02FF02">&#39;&#39;</span> )
        <span style="color: #FF8000">if</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">tools</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">acnt_in_web</span>( <span style="color: #FFFFFF">name</span>, <span style="color: #FFFFFF">web</span>,
                                   <span style="color: #FFFFFF">spaces</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">False</span> ) :
            <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">acnt_in_link</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">True</span>
            <span style="color: #FF8000">return</span> <span style="color: #FF69B4">True</span>
        <span style="color: #FF8000">return</span> <span style="color: #FF69B4">False</span>

    <span style="color: #FF8000">def</span> <span style="color: #5E5EFF">resolution</span>( <span style="color: #FF69B4">self</span> ) :
        <span style="color: #02FF02">&#39;&#39;&#39;</span>
<span style="color: #02FF02">        Last Step: Check the archive file and</span>
<span style="color: #02FF02">        validate link, append cache with link</span>
<span style="color: #02FF02">        resolution, &quot;wrap up&quot; the information</span>
<span style="color: #02FF02">        store, and then return the resolution.</span>
<span style="color: #02FF02">        &#39;&#39;&#39;</span>
        <span style="color: #DD0000"># Check and, if link was found,</span>
        <span style="color: #DD0000"># validate archive</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">validate_archive</span>()
        <span style="color: #DD0000"># Find you a link!</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">find_linkage</span>()
        <span style="color: #DD0000"># Store found linkage</span>
        <span style="color: #FF8000">if</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">linkage</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">empty</span> :
            <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">linkage</span> <span style="color: #FF8000">=</span> <span style="color: #02FF02">&#39;Program Could Not Find Link&#39;</span>
            <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span>[ <span style="color: #02FF02">&#39;Found Link&#39;</span> ]<span style="color: #FF8000">.</span><span style="color: #FFFFFF">append</span>( <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">linkage</span> )
        <span style="color: #FF8000">else</span> :
            <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">link_duns</span>()
            <span style="color: #FFFFFF">link</span> <span style="color: #FF8000">=</span> <span style="color: #02FF02">&#39;, &#39;</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">join</span>( <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">linkage</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">tolist</span>() )
            <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span>[ <span style="color: #02FF02">&#39;Found Link&#39;</span> ]<span style="color: #FF8000">.</span><span style="color: #FFFFFF">append</span>( <span style="color: #FFFFFF">link</span> )
            <span style="color: #DD0000"># If link has no D-U-N-S number,</span>
            <span style="color: #DD0000"># contact account deployment.</span>
            <span style="color: #FF8000">for</span> <span style="color: #FFFFFF">col</span> <span style="color: #FF8000">in</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">linkage</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">index</span> :
                <span style="color: #FF8000">if</span> <span style="color: #02FF02">&#39;DUNS&#39;</span> <span style="color: #FF8000">in</span> <span style="color: #FFFFFF">col</span> :
                    <span style="color: #FFFFFF">colm</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">col</span>
                    <span style="color: #FF8000">break</span>
            <span style="color: #FF8000">if</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">linkage</span>[ <span style="color: #FFFFFF">colm</span> ] <span style="color: #FF8000">==</span> <span style="color: #02FF02">&#39;&#39;</span> :
                <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">resolve</span> <span style="color: #FF8000">+=</span> <span style="color: #02FF02">&#39; - Contact Account Deployment&#39;</span>
        <span style="color: #FF8000">if</span> <span style="color: #FF8000">not</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">resolve</span> :
            <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">resolve</span> <span style="color: #FF8000">=</span> <span style="color: #02FF02">&#39;Program Could Not Validate&#39;</span>
        <span style="color: #DD0000"># Append cache</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">links</span>[ ( <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">account</span>,
                      <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">analyte</span>,
                      <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">issueid</span> )
                  ] <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">linkage</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">resol</span>[ ( <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">account</span>,
                      <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">analyte</span>,
                      <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">issueid</span> )
                  ] <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">resolve</span>
        <span style="color: #DD0000"># Finalize information store</span>
        <span style="color: #FF8000">for</span> <span style="color: #FFFFFF">key</span> <span style="color: #FF8000">in</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">keys</span>():
            <span style="color: #FFFFFF">val</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span>[ <span style="color: #FFFFFF">key</span> ]
            <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span>[ <span style="color: #FFFFFF">key</span> ] <span style="color: #FF8000">=</span> <span style="color: #02FF02">&#39; | &#39;</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">join</span>( <span style="color: #FFFFFF">val</span> )
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span>[ <span style="color: #02FF02">&#39;Resolution&#39;</span> ] <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">resolve</span>
        <span style="color: #FFFFFF">pd</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">set_option</span>( <span style="color: #02FF02">&#39;display.max_colwidth&#39;</span>, <span style="color: #FF00FF">10000</span> )
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">pd</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">DataFrame</span>(
            <span style="color: #FFFFFF">index</span>   <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">keys</span>(),
            <span style="color: #FFFFFF">data</span>    <span style="color: #FF8000">=</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">values</span>(),
            <span style="color: #FFFFFF">columns</span> <span style="color: #FF8000">=</span> [ <span style="color: #02FF02">&#39;Info&#39;</span> ] )
        <span style="color: #DD0000"># End</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">track</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">clear</span>()
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">total</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">logtime</span>()
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">total</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">endpage</span>()
        <span style="color: #FF8000">return</span> <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">resolve</span>

    <span style="color: #FF8000">def</span> <span style="color: #5E5EFF">reset</span>( <span style="color: #FF69B4">self</span> ) :
        <span style="color: #02FF02">&#39;&#39;&#39;</span>
<span style="color: #02FF02">        Helper Function:</span>
<span style="color: #02FF02">        Reset processing parameters.</span>
<span style="color: #02FF02">        &#39;&#39;&#39;</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">resolve</span> <span style="color: #FF8000">=</span> <span style="color: #02FF02">&#39;&#39;</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">handoff</span> <span style="color: #FF8000">=</span> <span style="color: #02FF02">&#39;&#39;</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">parents</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">False</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">orphans</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">False</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">linkage</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">pd</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">Series</span>()
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">archive</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">pd</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">Series</span>()
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">parent_title</span> <span style="color: #FF8000">=</span> <span style="color: #02FF02">&#39;&#39;</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">entity_title</span> <span style="color: #FF8000">=</span> <span style="color: #02FF02">&#39;&#39;</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">analyte_arch</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">False</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">validarchive</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">False</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">acnt_in_arch</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">False</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">acnt_in_link</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">False</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">parent_in_aw</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">False</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">entity_in_aw</span> <span style="color: #FF8000">=</span> <span style="color: #FF69B4">False</span>
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">parentresult</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">pd</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">DataFrame</span>()
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">entityresult</span> <span style="color: #FF8000">=</span> <span style="color: #FFFFFF">pd</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">DataFrame</span>()
        <span style="color: #FF69B4">self</span><span style="color: #FF8000">.</span><span style="color: #FFFFFF">info</span> <span style="color: #FF8000">=</span> {
            <span style="color: #02FF02">&#39;Associated Account&#39;</span> : [], <span style="color: #02FF02">&#39;Assoc. Acc. in AW&#39;</span> : [],
            <span style="color: #02FF02">&#39;Parent Account&#39;</span>     : [], <span style="color: #02FF02">&#39;Parent Acc. in AW&#39;</span> : [],
            <span style="color: #02FF02">&#39;Found Link&#39;</span>         : [], <span style="color: #02FF02">&#39;Hierarchy&#39;</span>         : [],
            <span style="color: #02FF02">&#39;Archived Link&#39;</span>      : [], <span style="color: #02FF02">&#39;Archived Hierarchy&#39;</span>: [],
            <span style="color: #02FF02">&#39;Resolution&#39;</span>         : []
            }
</pre></div>
</td></tr></table>
    </div>
  </body>
</html>
